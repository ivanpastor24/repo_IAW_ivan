version: '3.1'
services:
 bookmedik:
  container_name: bookmedik
  image: ivanpastor00/bookmedik:v1 
  restart: always
  environment:
   - DB_HOST=${DB_HOST}
   - DB_USER=${DB_USER} 
   - DB_PASS=${DB_PASS}
   - DB_NAME=${DB_NAME}
  ports:
   - 8080:80
  depends_on:
   - mysql
 mysql:
  container_name: mysql
  image: mariadb:latest
  healthcheck:
   test: ["CMD-SHELL", "mysqladmin ping -h localhost -u$MYSQL_USER -p$MYSQL_PASSWORD --silent"]
   interval: 10s
   timeout: 5s
   retries: 5
   start_period: 30s
  restart: always
  environment:
   - MYSQL_DATABASE=${MYSQL_DATABASE}
   - MYSQL_USER=${MYSQL_USER}
   - MYSQL_PASSWORD=${MYSQL_PASSWORD}
   - MYSQL_ROOT_PASSWORD=${MYSQL_ROOT_PASSWORD}
  volumes:
   - mariadb_backup_bookmedik:/var/lib/mysql
volumes:
 mariadb_backup_bookmedik:
